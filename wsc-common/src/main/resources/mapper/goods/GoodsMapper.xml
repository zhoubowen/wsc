<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.common.dao.goods.IGoodsDao">
  <resultMap id="goodsMap" type="goodsEntity">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="goods_id" jdbcType="INTEGER" property="goodsId" />
    <result column="goods_title" jdbcType="VARCHAR" property="goodsTitle" />
    <result column="goods_sub_title" jdbcType="VARCHAR" property="goodsSubTitle" />
    <result column="goods_pic_id" jdbcType="INTEGER" property="goodsPicId" />
    <result column="goods_detail_html" jdbcType="VARCHAR" property="goodsDetailHtml" />
    <result column="goods_detail_html_url" jdbcType="VARCHAR" property="goodsDetailHtmlUrl" />
    <result column="create_date" jdbcType="TIMESTAMP" property="createDate" />
    <result column="last_update_date" jdbcType="TIMESTAMP" property="lastUpdateDate" />
    <result column="goods_online" jdbcType="BIT" property="goodsOnline" />
    <result column="goods_season_id" jdbcType="INTEGER" property="goodsSeasonId" />
    <result column="goods_category_first" jdbcType="INTEGER" property="goodsCategoryFirst" />
    <result column="goods_category_second" jdbcType="INTEGER" property="goodsCategorySecond" />
    <result column="goods_category_third" jdbcType="INTEGER" property="goodsCategoryThird" />
    
    <association property="goodsPicFile" fetchType="lazy" javaType="picFileEntity">
      <id column="id" property="id"/>
      <result column="file_name" property="fileName"/>
      <result column="bucket_name" property="bucketName"/>
    </association>

  </resultMap>

  <sql id="full_goods_column">
    g.goods_id,
    g.goods_title,
    g.goods_sub_title,
    g.goods_detail_html,
    g.goods_detail_html_url,
    g.create_date,
    g.last_update_date,
    g.goods_online,
    g.goods_season_id,
    g.goods_category_first,
    g.goods_category_second,
    g.goods_category_third,

    p.id,
    p.file_name,
    p.bucket_name
  </sql>

  <insert id="insert" parameterType="goodsEntity">
    insert into t_goods
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="goods.goodsTitle != null">
        goods_title,
      </if>
      <if test="goods.goodsSubTitle != null">
        goods_sub_title,
      </if>
      <if test="goods.goodsPicFile != null">
        goods_pic_id,
      </if>
      <if test="goods.goodsDetailHtml != null">
        goods_detail_html,
      </if>
      <if test="goods.goodsDetailHtmlUrl != null">
        goods_detail_html_url,
      </if>
        create_date,
        last_update_date,
      <if test="goods.goodsOnline != null">
        goods_online,
      </if>
      <if test="goods.goodsSeasonId != null">
        goods_season_id,
      </if>
      <if test="goods.goodsCategoryFirst != null">
        goods_category_first,
      </if>
      <if test="goods.goodsCategorySecond != null">
        goods_category_second,
      </if>
      <if test="goods.goodsCategoryThird != null">
        goods_category_third,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="goods.goodsTitle != null">
        #{goods.goodsTitle,jdbcType=VARCHAR},
      </if>
      <if test="goods.goodsSubTitle != null">
        #{goods.goodsSubTitle,jdbcType=VARCHAR},
      </if>
      <if test="goods.goodsPicFile != null">
        #{goods.goodsPicFile.id,jdbcType=INTEGER},
      </if>
      <if test="goods.goodsDetailHtml != null">
        #{goods.goodsDetailHtml,jdbcType=VARCHAR},
      </if>
      <if test="goods.goodsDetailHtmlUrl != null">
        #{goods.goodsDetailHtmlUrl,jdbcType=VARCHAR},
      </if>
      now(),
      now(),
      <if test="goods.goodsOnline != null">
        #{goods.goodsOnline,jdbcType=BIT},
      </if>
      <if test="goods.goodsSeasonId != null">
        #{goods.goodsSeasonId,jdbcType=INTEGER},
      </if>
      <if test="goods.goodsCategoryFirst != null">
        #{goods.goodsCategoryFirst,jdbcType=INTEGER},
      </if>
      <if test="goods.goodsCategorySecond != null">
        #{goods.goodsCategorySecond,jdbcType=INTEGER},
      </if>
      <if test="goods.goodsCategoryThird != null">
        #{goods.goodsCategoryThird,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>

  <delete id="delete" parameterType="java.lang.Integer">
      delete from t_goods where goods_id = ${goodsId}
  </delete>

  <update id="update" parameterType="goodsEntity">
    update t_goods
    <set>
      <if test="goodsTitle != null">
        goods_title = #{goodsTitle,jdbcType=VARCHAR},
      </if>
      <if test="goodsSubTitle != null">
        goods_sub_title = #{goodsSubTitle,jdbcType=VARCHAR},
      </if>
      <if test="goodsPicFile != null">
        goods_pic_id = #{goodsPicFile.id,jdbcType=INTEGER},
      </if>
      <if test="goodsDetailHtml != null">
        goods_detail_html = #{goodsDetailHtml,jdbcType=VARCHAR},
      </if>
      <if test="goodsDetailHtmlUrl != null">
        goods_detail_html_url = #{goodsDetailHtmlUrl,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="lastUpdateDate != null">
        last_update_date = #{lastUpdateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="goodsOnline != null">
        goods_online = #{goodsOnline,jdbcType=BIT},
      </if>
      <if test="goodsSeasonId != null">
        goods_season_id = #{goodsSeasonId,jdbcType=INTEGER},
      </if>
      <if test="goodsCategoryFirst != null">
        goods_category_first = #{goodsCategoryFirst,jdbcType=INTEGER},
      </if>
      <if test="goodsCategorySecond != null">
        goods_category_second = #{goodsCategorySecond,jdbcType=INTEGER},
      </if>
      <if test="goodsCategoryThird != null">
        goods_category_third = #{goodsCategoryThird,jdbcType=INTEGER},
      </if>
    </set>
    where goods_id = #{goodsId,jdbcType=INTEGER}
  </update>

  <select id="findById" parameterType="java.lang.Integer" resultMap="goodsMap">
    select
      <include refid="full_goods_column"/>
    from t_goods g
    LEFT JOIN t_pic_file p on g.goods_pic_id = p.id
    where goods_id = #{goodsId}
  </select>

  <select id="findCount" parameterType="com.common.dto.goods.GoodsSearchDto" resultType="java.lang.Integer">
    select count(1) from t_goods
  </select>

  <select id="findPageList" parameterType="java.util.HashMap" resultMap="goodsMap">
    select
    <include refid="full_goods_column"/>
    from t_goods g
    LEFT JOIN t_pic_file p on g.goods_pic_id = p.id

  </select>

</mapper>